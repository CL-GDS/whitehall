<% content_for :page_title, "Roles" %>
<% content_for :title, "Roles" %>

<%= render "govuk_publishing_components/components/warning_text", {
  text: "Do not create ministerial roles without consulting GDS.",
  highlight_text: true
} %>

<%= render "govuk_publishing_components/components/button", {
  title: "Create a role",
  text: "Create role",
  secondary_solid: true,
  href: new_admin_role_path
} %>

<%= render "govuk_publishing_components/components/table", {
  head: [
    {
      text: "Name"
    },
    {
      text: "Organistions"
    },
    {
      text: "Role type"
    },
    {
      text: "Currently appointed"
    },
    {
      text: "Translations"
    },
    {
      text: "Actions"
    }
  ],
  rows: @roles.map do |role|
    [
      {
        text: link_to(role.name, edit_admin_role_path(role), title: "Edit role #{role.name}", class: "govuk-link")
      },
      {
        text: role.organisation_names
      },
      {
        text: role.role_type.humanize
      },
      {
        text: role.current_person_name
      },
      {
        text:
          content_tag_for(:div, role) do
            link_to(sanitize("Manage translations#{tag.span(role.name, class: "govuk-visually-hidden")}"), admin_role_translations_path(role), title: "Manage translations of #{role.name}", class: "govuk-link")
          end
      },
      {
        text:
            if role.destroyable?
                form_tag admin_role_path(role), method: :delete  do
                  render "govuk_publishing_components/components/button", {
                    text: "delete",
                    destructive: true
                  }
                end
            else
              tag.span("Cannot delete")
            end
      }
    ]
    end
} %>
